<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
	xmlns:mongo="http://www.springframework.org/schema/data/mongo"
	xsi:schemaLocation="http://www.springframework.org/schema/context
	          http://www.springframework.org/schema/context/spring-context.xsd
	          http://www.springframework.org/schema/data/mongo         
	          http://www.springframework.org/schema/data/mongo/spring-mongo.xsd          
	          http://www.springframework.org/schema/beans          
	          http://www.springframework.org/schema/beans/spring-beans.xsd">    

    <!-- Configure Properties for DB Connection -->
	
    <!-- Mongo DB Beans -->
	
	<bean id="mongoServers" class="java.util.ArrayList">
    <constructor-arg>
        <list>
            <bean class="com.mongodb.ServerAddress">
				<constructor-arg type="java.lang.String" name="host" value="mongo1" />
		        <constructor-arg type="int" name="port" value="27017" />
		    </bean>
           <bean class="com.mongodb.ServerAddress">
				<constructor-arg type="java.lang.String" name="host" value="mongo2" />
		        <constructor-arg type="int" name="port" value="27017" />
		    </bean>
        </list>
    </constructor-arg>
    </bean>

    <!-- Credentials -->
    <bean id="mongoCredentialList" class="java.util.ArrayList">
    <constructor-arg>
        <list>
            <ref bean="mongoCredential" />
        </list>
    </constructor-arg>
    </bean>

    <bean id="mongoCredential" class="com.mongodb.MongoCredential">
            <constructor-arg name="mechanism" value = "#{T(com.mongodb.AuthenticationMechanism).SCRAM_SHA_1}" />
            <constructor-arg type="java.lang.String" name="userName" value="oneassist" />
            <constructor-arg type="java.lang.String" name="source" value="cmsdocuments" />
            <constructor-arg type="char[]" name="password" value="oneassist123" />
    </bean>

    <!-- MongoClient -->
    <bean id="mongoClient" class="com.mongodb.MongoClient">
            <constructor-arg ref="mongoServers" />
            <constructor-arg ref="mongoCredential"  />
    </bean>

    <!-- MongoDbFactory -->
    <bean id="mongoDbFactory" class="org.springframework.data.mongodb.core.SimpleMongoDbFactory">
        <constructor-arg ref="mongoClient" />
        <constructor-arg name="databaseName" value="cmsdocuments" />
        <property name="writeConcern" ref="mongoWriteConcern" />
    </bean>

    <!-- MongoTemplate -->
    <bean id="mongoTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
        <constructor-arg ref="mongoDbFactory" />
    </bean>
    
    <bean id="gridTemplate" class="org.springframework.data.mongodb.gridfs.GridFsTemplate">
		<constructor-arg ref="mongoDbFactory" />
		<constructor-arg ref="converter" />
	</bean>
	
	<bean id="mongoWriteConcern" class="com.mongodb.WriteConcern">
		<constructor-arg type="int" name="w" value="2" />
     </bean>
	<mongo:mapping-converter id="converter"
		db-factory-ref="mongoDbFactory" />
</beans>